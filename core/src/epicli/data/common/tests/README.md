# Unit testing infrastructure

## Folder structure

* Inside ```spec/``` folder create a role that you want to test.
* In the created folder create tests with file name ending with ```_spec.rb```

## Ansible inventory

These test are ment to have ansible inventory on the input. Inventory groups must match folder names in ```spec/``` folder.

## Setup

* Install ruby
* ```bundle install```

## Running 

To run the tests use:
```
rake inventory=/home/username/epiphany/build/epiphany/epiphany-vsts-demo/inventory/development user=operations keypath=/home/pljazim/keys/id_rsa spec:all
```

Where:

```inventory``` is a path to your inventory file generated by epiphany (or any other for that matter)
```user``` is the name of the user attached to the key that you are using
```keypath``` is the path to the key that you want to use (-i parameter for ssh). NOTE: Make sure you have correct permissions to the key (600)

## Additional materials

* https://vincent.bernat.im/en/blog/2014-serverspec-test-infrastructure
